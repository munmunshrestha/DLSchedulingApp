
/* Smart HTML Elements v4.4.0 (2019-Sep) 
Copyright (c) 2011-2019 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart.Utilities.Assign("Grid.Export",class{exportData(a){const b=this,c=new Smart.Utilities.DataExporter({exportHeader:b.dataExport.header});if(c.expandChar=b.dataExport.expandChar,c.collapseChar=b.dataExport.collapseChar,c.pageOrientation=b.dataExport.pageOrientation,c.style=b.dataExport.style,c.filterBy=b.dataExport.filterBy,c.groupBy=b.dataExport.groupBy,c.header={columns:b.columns.toArray().slice(0),columngroups:b.columnGroups.slice(0)},!b.dataExport.style){const a=window.getComputedStyle(b),d=window.getComputedStyle(0<b.columns.length&&b.columns[0].element?b.columns[0].element:b.$.columnHeader),e=window.getComputedStyle(b.$.columnHeader),f=0===b.offsetWidth||0===b.offsetHeight;if(!f){const f=a=>{function b(a){return a=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),a?"#"+c(a[1])+c(a[2])+c(a[3]).toUpperCase():"#ffffff"}function c(a){return isNaN(a)?"00":h[(a-a%16)/16]+h[a%16]}const d=a.fontSize,e=a.borderRightColor,f=a.backgroundColor,g=a.color,h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return{borderColor:b(e),fontSize:d,fontFamily:"Helvetica",color:b(g),backgroundColor:b(f)}},g=f(a),h=f(d),i=f(e),j={height:b.$.columnHeader.offsetHeight+"px",border:"1px solid "+g.borderColor,fontFamily:i.fontFamily,fontSize:i.fontSize,color:i.color,backgroundColor:h.backgroundColor,fontWeight:"400"},k={border:"1px solid "+g.borderColor,fontFamily:g.fontFamily,fontSize:g.fontSize,color:g.color,backgroundColor:g.backgroundColor},l={height:b.rowMinHeight+"px"};for(let a=0;a<b.columns.length;a++){const c=b.columns[a];if(!c.allowExport)continue;if(!c.visible)continue;j[c.dataField]={textAlign:c.align,width:c.computedWidth+"px",format:c.cellsFormat||""};let d=c.cellsFormat||"";"date"===c.dataType?d="d":"dateTime"===c.dataType?d="D":"time"===c.dataType&&(d="t"),k[c.dataField]={textAlign:c.cellsAlign,format:d}}0<b.appearance.alternationCount&&(l.alternationCount=b.appearance.alternationCount,l.alternationStart=b.appearance.alternationStart,l.alternationEnd=b.appearance.alternationEnd,l.alternationIndex0Color=g.backgroundColor,l.alternationIndex0BackgroundColor=g.color,l.alternationIndex1Color="#aaa",l.alternationIndex1BackgroundColor="#333"),c.style={border:"1px solid "+g.borderColor,borderCollapse:"collapse",header:j,columns:k,rows:l}}}const d=!b.rowHierarchy||b.grouping.enabled?b.rows.toArray():b.rowHierarchy;let e=[];for(let b=0;b<d.length;b++){const a=d[b];a.visible&&(!1!==a.filtered||void 0===a.filtered)&&e.push(a.data)}d===b.rowHierarchy&&(e=b.dataSource.boundHierarchy,c.hierarchical=!0),!b.dataExport.groupBy&&b.grouping.enabled&&b.dataSource&&b.dataSource.groupBy&&(c.groupBy=b.dataSource.groupBy.toArray()),b.checkLicense(!0),c.exportData(e,a,b.dataExport.fileName)}});