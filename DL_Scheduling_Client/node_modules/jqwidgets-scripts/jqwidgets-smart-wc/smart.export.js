
/* Smart HTML Elements v4.4.0 (2019-Sep) 
Copyright (c) 2011-2019 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart.Utilities.Assign("DataExporter",class{constructor(e,t,l,o){const n=this;e||(e={}),n.style=e.style,n.header=e.header,n.exportHeader=e.exportHeader||!0,n.hierarchical=e.hierarchical,n.expandChar=e.expandChar||"+",n.collapseChar=e.collapseChar||"-",n.pageOrientation=e.pageOrientation,!n.hierarchical&&t&&0<t.length?n.groupBy=t:n.mergedCells=e.mergedCells,!n.groupBy&&l&&0<Object.keys(l).length&&(n.filterBy=l),o&&(n.conditionalFormatting=o),n.timeBetween1900And1970=new Date(1970,0,1).getTime()-new Date(1900,0,1).getTime()}downloadFile(e,t,l){let o;if(o=e instanceof Blob?e:new Blob([e],{type:t}),window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(o,l);else{const e=document.createElement("a"),t=URL.createObjectURL(o);e.href=t,e.download=l,e.style.position="absolute",e.style.visibility="hidden",document.body.appendChild(e),e.click(),setTimeout(function(){document.body.removeChild(e),window.URL.revokeObjectURL(t)},0)}}exportData(e,t,l){const o=this;return(o.actualHierarchy=o.hierarchical,t=t.toLowerCase(),o.exportHeader&&(o.header?(e=e.slice(0),0===e.length&&(o.actualHierarchy=!1),o.processComplexHeader(o.header,e,t)):1===e.length&&(o.actualHierarchy=!1)),0===e.length)?void console.warn("No data to export."):void("xlsx"===t&&(o.xlsxStartIndex=o.complexHeader?o.complexHeader.length:+o.exportHeader),o.actualHierarchy&&(e=o.processHierarchicalData(e,t)),o.getDatafields(e),l.slice(l.length-t.length-1,l.length)!=="."+t&&(l+="."+t),"csv"===t?o.exportToCSVAndTSV(e,{delimiter:", ",MIME:"text/csv",toRemove:2},l):"html"===t?o.exportToHTML(e,l):"json"===t?o.exportToJSON(e,l):"pdf"===t?o.exportToPDF(e,l):"tsv"===t?o.exportToCSVAndTSV(e,{delimiter:"\t",MIME:"text/tab-separated-values",toRemove:1},l):"xlsx"===t?o.exportToXLSX(e,l):"xml"===t?o.exportToXML(e,l):void 0,delete o.complexHeader)}exportToCSVAndTSV(e,t,l){const o=this,n=o.datafields;let r="";for(let a=0;a<e.length;a++){const l=e[a];let i="";for(let e=0;e<n.length;e++){if(o.actualHierarchy&&0==e){i+=("\"\""+t.delimiter).repeat(l._level-1)+"\""+l[n[e]]+"\""+t.delimiter+("\"\""+t.delimiter).repeat(o.maxLevel-l._level);continue}i+="\""+l[n[e]]+"\""+t.delimiter}i=i.slice(0,i.length-t.toRemove)+"\n",r+=i}this.downloadFile(r,t.MIME,l)}exportToHTML(e,t){const l=this,o=l.datafields,n=l.style;let r="",a=0;e=l.processGroupingInformation(e),l.data=e,l.exportHeader&&(r=l.getHTMLHeader(o,e),a=1);let d=`<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style type="text/css">
${l.getRowStyle()}${l.getColumnStyle()}
    </style>${l.toggleableFunctionality()}
</head>
<body>
    <table${l.getTableStyle()}>${r}
        <tbody>\n`;const i={},s={},p=[];l.getMergedCellsInfo(i,s);mainLoop:for(let t=a;t<e.length;t++){const r=e[t],c=t-a;let u=l.getAlternationIndex(c," rowN"),h="",m="",g="",f=0;if(l.actualHierarchy)r._collapsed&&(h=" collapsed"),m=` level="${r._level}"`;else if(l.groupBy)for(let e=0;e<l.groupBy.length;e++){const o=l.groupBy[e],n=r[o],a=l.groups[o][n];if(g+=n,-1===p.indexOf(g)){d+=`            <tr class="row">
                <td class="column group" style="padding-left: ${25*f}px;" colspan="${l.datafields.length}">${a}</td>
            </tr>`,p.push(g),t--;continue mainLoop}f++}let x=`            <tr class="row row${c}${u}${h}"${m}>\n`;for(let e=0;e<o.length;e++){const t=e+","+c;let a=1,d=1;if(i[t])a=i[t].colspan,d=i[t].rowspan;else if(s[t])continue;const p=o[e];let u=r[p],h="";if(l.actualHierarchy&&0==e){let e="";r._expanded?e=l.collapseChar:!1===r._expanded&&(e=l.expandChar),h=`<div class="toggle-element" style="margin-left: ${25*(r._level-1)+5}px;" expanded>${e}</div>`}u=l.getFormattedValue(u,p);let m="";if(n&&n.columns&&n.columns[p]&&n.columns[p][c]){const e=n.columns[p][c];m+=`border-color: ${e.border}; background-color: ${e.background}; color: ${e.color};"`}0==e&&1<f&&(m+=`padding-left: ${25*(f-1)}px;"`),m&&(m=` style="${m}"`),x+=`                <td class="column column${p}"${m} colspan="${a}" rowspan="${d}">${h+u}</td>\n`}d+=x+"            </tr>\n"}d+=`        </tbody>
    </table>
</body>
</html>`,this.downloadFile(d,"text/html",t)}getMergedCellsInfo(e,t,l){const o=this;if(o.mergedCells){const n=l&&0!==l[o.datafields.length-1];o.mergedCellsPDF=o.mergedCells.slice(0);for(let r=0;r<o.mergedCellsPDF.length;r++){const a=o.mergedCellsPDF[r];let i=a.colspan,d=a.rowspan;if(2>d&&2>i)continue;const s=a.cell[1];let p=a.cell[0];if(n&&1<i){const e=l[p],t=l[p+i-1],n=[];if(t>e){let r=e,a=p,c=0;mainLoop:for(let o=e;o<=t;o++){let e=a,t=0;for(;l[a]===r;)if(a++,c++,t++,c===i){n.push({start:e,span:t});break mainLoop}n.push({start:e,span:t}),r=l[a]}i=n[0].span;for(let e=1;e<n.length;e++)o.mergedCellsPDF.push({cell:[n[e].start,s],colspan:n[e].span,rowspan:d,originalCell:p})}}for(let l=p;l<p+i;l++)for(let o=s;o<s+d;o++){const n=l+","+o;if(l===p&&o===s){e[n]={colspan:i,rowspan:d,originalCell:a.originalCell};continue}t[n]=!0}}}}getAlternationIndex(e,t){const l=this;if(!l.style)return"";const o=l.style.rows,n=o&&o.alternationCount;return!n||o.alternationStart&&e<o.alternationStart||o.alternationEnd&&e>o.alternationEnd?"":t+e%o.alternationCount}getFormattedValue(e,t){const l=this,o=l.style;if(t&&o&&o.columns&&o.columns[t]&&o.columns[t].format){if("number"==typeof e)return l.formatNumber(e,o.columns[t].format);if(e instanceof Date)return l.formatDate(e,o.columns[t].format)}else if(e instanceof Date)return l.formatDate(e,"d");return e}exportToJSON(e,t){this.downloadFile(JSON.stringify(e,this.datafields.concat("rows")),"application/json",t)}exportToPDF(e,t){function l(){let e=[];for(let t=0;t<u.length;t++)e.push([]);return e}const o=this,r=o.datafields,a=+o.exportHeader,n=[],i={},d={},s={},p=a?o.complexHeader?o.complexHeader.length:1:0,c={pageOrientation:o.pageOrientation||"portrait"};let u,h=[],m=[];e=o.processGroupingInformation(e),o.data=e,o.headerRows=p,o.getPDFStyle();const g=o.styleInfo;u=g?o.wrapPDFColumns(c,s):[{body:h,datafields:r}],a&&(h=o.getPDFHeader(r,u,s)),o.getMergedCellsInfo(i,d,s);mainLoop:for(let t=a;t<e.length;t++){const p=e[t];let i="",c=0;if(o.groupBy)for(let e=0;e<o.groupBy.length;e++){const l=o.groupBy[e],r=p[l],a=o.groups[l][r];if(i+=r,-1===n.indexOf(i)){o.createGroupHeaderRow(u,{text:a,style:["row","cell","group"],marginLeft:7.5*c}),n.push(i),t--;continue mainLoop}c++}const h=l(),m=t-a;let g=o.getAlternationIndex(m,"");for(let e=0;e<r.length;e++){const t=r[e],l={style:["row","row"+m,"cell","cell"+t]},n=s[e]||0;if(void 0!==g&&l.style.splice(1,0,"rowN"+g),o.mergedCellsPDF){const t=e+","+m,o=i[t];if(o){if(l.colSpan=o.colspan,l.rowSpan=o.rowspan,void 0!==o.originalCell){l.text="",l.style[l.style.length-1]="cell"+r[o.originalCell],h[n].push(l);continue}}else if(d[t]){h[n].push({});continue}}const a=o.getFormattedValue(p[t],t);l.text=a.toString(),o.getUniqueStylePDF(l,t,m),o.setIndentation(l,{j:e,currentRecord:p,value:a,outlineLevel:c}),h[n].push(l)}for(let e=0;e<u.length;e++)u[e].body.push(h[e])}if(g){for(let e=0;e<u.length;e++){const t=u[e].body;for(let l=p-1;0<=l;l--)t.unshift(h[e][l]);m.push({table:{headerRows:p,widths:u[e].widths,heights:function(e){return g.heights[e]?g.heights[e]:g.defaultHeight?g.defaultHeight:void 0},body:t},pageBreak:"after"})}delete m[u.length-1].pageBreak,c.styles=g.styles}else{const e=u[0].body;for(let t=p-1;0<=t;t--)e.unshift(h[0][t]);m=[{table:{headerRows:p,body:e}}],c.styles={header:{bold:!0},group:{bold:!0}}}c.content=m,pdfMake.createPdf(c).download(t),delete o.mergedCellsPDF,delete o.styleInfo}getPDFStyle(){function e(e,l){if(e)for(let n in e)if(e.hasOwnProperty(n))if(void 0!==o[n])for(let o in e[n]){if(!isNaN(o)||!e[n].hasOwnProperty(o))continue;const r=e[n][o],a=t.datafields.indexOf(n);"width"==o&&"*"===d.widths[a]?d.widths[a]=parseFloat(r):t.storePDFStyle({prop:o,value:r,toUpdate:l+n})}else if("height"==n&&"header"===l)for(let l=0;l<t.headerRows;l++)d.heights[l]=parseInt(e[n],10)/t.headerRows/1.57;else t.storePDFStyle({prop:n,value:e[n],toUpdate:l})}const t=this,l=t.style;if(!l)return"";const o=t.data[0],n=l.header,r=l.columns,a=l.rows,d={heights:[],widths:Array(t.datafields.length).fill("*"),styles:{header:{},row:{},cell:{},group:{fillColor:"#FFFFFF",color:"#000000",bold:!0}}};if(t.styleInfo=d,e(n,"header"),e(r,"cell"),!!a){for(let e in a){if(!a.hasOwnProperty(e)||-1!==e.indexOf("alt"))continue;const l=a[e];if(!isNaN(e)){for(let o in l)l.hasOwnProperty(o)&&("height"==o?d.heights[parseFloat(e)+t.headerRows]=parseFloat(l[o])/1.57:t.storePDFStyle({prop:o,value:l[o],toUpdate:"row"+e}));continue}"height"==e?d.defaultHeight=parseFloat(l)/1.57:t.storePDFStyle({prop:e,value:l,toUpdate:"row"})}if(a.alternationCount)for(let e=0;e<a.alternationCount;e++){const t={};a[`alternationIndex${e}Color`]&&(t.color=a[`alternationIndex${e}Color`]),a[`alternationIndex${e}BackgroundColor`]&&(t.fillColor=a[`alternationIndex${e}BackgroundColor`]),d.styles["rowN"+e]=t}}}storePDFStyle(e){const t=this;let l=t.styleInfo.styles[e.toUpdate];l||(l={},t.styleInfo.styles[e.toUpdate]=l);let o=e.value;switch(e.prop){case"backgroundColor":l.fillColor=o;break;case"color":l.color=o;break;case"fontSize":l.fontSize=parseFloat(o);break;case"fontStyle":"italic"===o&&(l.italics=!0);break;case"fontWeight":"bold"===o&&(l.bold=!0);break;case"textAlign":l.alignment=o;}}wrapPDFColumns(e,t){const l=this,o=this.styleInfo,n="portrait"===e.pageOrientation?775:1155,r=[];let a=0;for(let d=0;d<o.widths.length;d++){let e=o.widths[d],i=e;if("*"===e?i=150:e>=n?(i=n,e="*"):e/=1.57,void 0===r[a]){r[a]={body:[],width:i,widths:[e],datafields:[l.datafields[d]]},t[d]=a;continue}const s=r[a];if(s.width+i>n){a++,d--;continue}t[d]=a,s.width+=i,s.widths.push(e),s.datafields.push(l.datafields[d])}return r}getPDFHeader(e,t,l){function o(e,t,l){for(let o=0;o<a;o++){const n=e[o],r=[];for(let t=0;t<n.length;t++){const i=n[t];let d=1,s=1;if(n[t-1]&&n[t-1]===i||e[o-1]&&e[o-1][t]===i){r.push({});continue}let p=t+1;for(;n[p]&&n[p]===n[p-1];)d++,p++;for(p=o+1;e[p]&&e[p][t]===i;)s++,p++;const c=o==a-1||s+o===a?l.datafields[t]:null,u={text:i,colSpan:d,rowSpan:s};c?u.style=["header","header"+c]:(u.alignment="center",u.style="header"),r.push(u)}t.push(r)}}const n=this,r=[],a=n.headerRows,d=n.complexHeader?n.complexHeader:[Object.values(n.data[0])],s=[];let p=[];for(let o=0;o<a;o++){const e=d[o];for(let t,n=0;n<e.length;n++)t=l[n]||0,s[t]||(s[t]=[]),s[t][o]||(s[t][o]=[]),s[t][o].push(e[n])}for(let n=0;n<t.length;n++)p=[],o(s[n],p,t[n]),r.push(p);return r}createGroupHeaderRow(e,t){for(let l=0;l<e.length;l++){const o=Object.assign({},t),n=e[l].datafields.length,r=[o];o.colSpan=n,r.length=n,r.fill({},1,n-1),e[l].body.push(r)}}getUniqueStylePDF(e,t,l){function o(e){const t=/rgba\((\d+),(\d+),(\d+)\,(\d*.\d+|\d+)\)/gi.exec(e.replace(/\s/g,"")),l=parseFloat(t[1]).toString(16).toUpperCase(),o=parseFloat(t[2]).toString(16).toUpperCase(),n=parseFloat(t[3]).toString(16).toUpperCase();return"#"+"0".repeat(2-l.length)+l+"0".repeat(2-o.length)+o+"0".repeat(2-n.length)+n}const n=this.style;if(n&&n.columns&&n.columns[t]){const r=n.columns[t][l];r&&(e.fillColor=o(r.background),e.color=r.color.toLowerCase())}}setIndentation(e,t){if(0===t.j){const l=this;if(l.actualHierarchy){const o=t.currentRecord;void 0===o._expanded?e.marginLeft=25*(o._level-1)+6:(e.marginLeft=25*(o._level-1),e.text=l.collapseChar+" "+t.value)}else 1<t.outlineLevel&&(e.marginLeft=7.5*(t.outlineLevel-1))}}exportToXLSX(e,t){const l=this;let o=l.style;if(e=l.processGroupingInformation(e,!0),l.data=e,l.getColumnsArray(),l.complexHeaderMergedCells=[],l.complexHeaderMergeInfo)for(let e in l.complexHeaderMergeInfo)if(l.complexHeaderMergeInfo.hasOwnProperty(e)){const t=l.complexHeaderMergeInfo[e];if(t.from[0]===t.to[0]&&t.from[1]===t.to[1])continue;l.complexHeaderMergedCells.push({from:l.columnsArray[t.from[1]]+(t.from[0]+1),to:l.columnsArray[t.to[1]]+(t.to[0]+1)})}l.getConditionalFormatting(),o||(o=l.generateDefaultStyle(e));const n=l.generateSharedStrings(e),r=n.collection,a=n.xml,i=l.generateStyles(o),d=l.groupBy?l.generateSheet1WithGrouping(e,r):l.generateSheet1(e,r),s=l.generateAuxiliaryFiles(),p=new JSZip,c=p.folder("_rels"),u=p.folder("docProps"),h=p.folder("xl"),m=h.folder("_rels"),g=h.folder("theme"),f=h.folder("worksheets");c.file(".rels",s._relsRels),u.file("app.xml",s.docPropsAppXml),u.file("core.xml",s.docPropsCoreXml),m.file("workbook.xml.rels",s.xl_relsWorkbookXmlRels),g.file("theme1.xml",s.xlThemeTheme1Xml),f.file("sheet1.xml",d),h.file("sharedStrings.xml",a),h.file("styles.xml",i),h.file("workbook.xml",s.xlWorkbookXml),p.file("[Content_Types].xml",s.Content_TypesXml),p.generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}).then(function(e){l.downloadFile(e,"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",t)}),delete l.conditionalFormattingXLSX,delete l.complexHeaderMergeInfo,delete l.defaultRowHeight,delete l.rowHeight}processGroupingInformation(e,t){const l=this;if(!l.groupBy)return e;let o;if(e=e.slice(0),l.exportHeader&&(t&&l.complexHeader?(o=e.slice(0,l.complexHeader.length),e.splice(0,l.complexHeader.length)):(o=[e[0]],e.splice(0,1))),1<e.length){const t=function(e,t){let l;switch(t||typeof e){case"string":l=new Intl.Collator().compare;break;case"number":l=function(e,t){return e-t};break;case"boolean":case"bool":l=function(e,t){return e===t?0:!1===e?-1:1};break;case"date":case"time":case"dateTime":e instanceof Date?l=function(e,t){return e.getTime()-t.getTime()}:(e instanceof Smart.Utilities.DateTime||e instanceof Smart.Utilities.BigNumber)&&(l=function(e,t){return e.compare(t)});break;case"object":if(e instanceof Date)l=function(e,t){return e.getTime()-t.getTime()};else if(e instanceof Smart.Utilities.DateTime||e instanceof Smart.Utilities.BigNumber)l=function(e,t){return e.compare(t)};else if(e instanceof Smart.Utilities.Complex||window.NIComplex&&e instanceof window.NIComplex){const e=new Smart.Utilities.ComplexNumericProcessor;l=function(t,l){return e.compareComplexNumbers(t,l)}}}return l};(function(e,l,o,n){if(!e||!Array.isArray(e)||0===e.length||!l||Array.isArray(l)&&0===l.length)return;"string"==typeof l&&(l=[l]);const r=[],d=[];void 0===o&&(o=[]);for(let a=0;a<l.length;a++)r[a]=void 0===o[a]||"asc"===o[a]||"ascending"===o[a]?1:-1,d[a]=t(e[0][l[a]]);return n?void n(e,l,o,d):void e.sort(function(e,t){for(let o=0;o<l.length;o++){const n=d[o](e[l[o]],t[l[o]]);if(0===n){if(l[o+1])continue;else if(void 0!==e._index)return(e._index-t._index)*r[o];return 0}return n*r[o]}})})(e,l.groupBy)}return o&&(e=o.concat(e)),l.getGroupLabels(e),e}exportToXML(e,t){function l(e,t){let n="";for(let r=0;r<e.length;r++){const a=e[r];n+=t+"<row>\n";for(let e=0;e<o.length;e++){const r=o[e];if("rows"===r){if(!a.rows)continue;n+=`${t}    <rows>\n${l(a.rows,t+"        ")}${t}    </rows>\n`;continue}n+=t+`    <${r}>${a[r]}</${r}>\n`}n+=t+"</row>\n"}return n}const o=this.datafields.slice(0);let n="<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<table>\n";-1===o.indexOf("rows")&&o.push("rows"),n+=l(e,"    ")+"</table>",this.downloadFile(n,"application/xml",t)}formatDate(t,e){if(!Smart.Utilities.DateTime)return t;try{return new Smart.Utilities.DateTime(t).toString(e)}catch(l){return t}}formatNumber(e,t){if(!Smart.Utilities.NumberRenderer)return e;const l=new Smart.Utilities.NumberRenderer,o=l.formatNumber(e,t);return void 0===o?e:o}generateAuxiliaryFiles(){const e=new Date().toISOString();return{_relsRels:"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\"><Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\" Target=\"docProps/app.xml\"/><Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\" Target=\"docProps/core.xml\"/><Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/></Relationships>",docPropsAppXml:`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Properties xmlns="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties" xmlns:vt="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"><Application>Microsoft Excel</Application><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size="2" baseType="variant"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>1</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size="1" baseType="lpstr"><vt:lpstr>Sheet1</vt:lpstr></vt:vector></TitlesOfParts><Company></Company><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>16.0300</AppVersion></Properties>`,docPropsCoreXml:`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<cp:coreProperties xmlns:cp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:dcmitype="http://purl.org/dc/dcmitype/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><dc:creator>Smart HTML Elements</dc:creator><cp:lastModifiedBy>Smart HTML Elements</cp:lastModifiedBy><dcterms:created xsi:type="dcterms:W3CDTF">${e}</dcterms:created><dcterms:modified xsi:type="dcterms:W3CDTF">${e}</dcterms:modified></cp:coreProperties>`,xl_relsWorkbookXmlRels:`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId3" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme" Target="theme/theme1.xml"/><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId4" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings" Target="sharedStrings.xml"/></Relationships>`,xlThemeTheme1Xml:`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1><a:dk2><a:srgbClr val="44546A"/></a:dk2><a:lt2><a:srgbClr val="E7E6E6"/></a:lt2><a:accent1><a:srgbClr val="4472C4"/></a:accent1><a:accent2><a:srgbClr val="ED7D31"/></a:accent2><a:accent3><a:srgbClr val="A5A5A5"/></a:accent3><a:accent4><a:srgbClr val="FFC000"/></a:accent4><a:accent5><a:srgbClr val="5B9BD5"/></a:accent5><a:accent6><a:srgbClr val="70AD47"/></a:accent6><a:hlink><a:srgbClr val="0563C1"/></a:hlink><a:folHlink><a:srgbClr val="954F72"/></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Calibri Light" panose="020F0302020204030204"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface="游ゴシック Light"/><a:font script="Hang" typeface="맑은 고딕"/><a:font script="Hans" typeface="等线 Light"/><a:font script="Hant" typeface="新細明體"/><a:font script="Arab" typeface="Times New Roman"/><a:font script="Hebr" typeface="Times New Roman"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="MoolBoran"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Times New Roman"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/><a:font script="Armn" typeface="Arial"/><a:font script="Bugi" typeface="Leelawadee UI"/><a:font script="Bopo" typeface="Microsoft JhengHei"/><a:font script="Java" typeface="Javanese Text"/><a:font script="Lisu" typeface="Segoe UI"/><a:font script="Mymr" typeface="Myanmar Text"/><a:font script="Nkoo" typeface="Ebrima"/><a:font script="Olck" typeface="Nirmala UI"/><a:font script="Osma" typeface="Ebrima"/><a:font script="Phag" typeface="Phagspa"/><a:font script="Syrn" typeface="Estrangelo Edessa"/><a:font script="Syrj" typeface="Estrangelo Edessa"/><a:font script="Syre" typeface="Estrangelo Edessa"/><a:font script="Sora" typeface="Nirmala UI"/><a:font script="Tale" typeface="Microsoft Tai Le"/><a:font script="Talu" typeface="Microsoft New Tai Lue"/><a:font script="Tfng" typeface="Ebrima"/></a:majorFont><a:minorFont><a:latin typeface="Calibri" panose="020F0502020204030204"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface="游ゴシック"/><a:font script="Hang" typeface="맑은 고딕"/><a:font script="Hans" typeface="等线"/><a:font script="Hant" typeface="新細明體"/><a:font script="Arab" typeface="Arial"/><a:font script="Hebr" typeface="Arial"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="DaunPenh"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Arial"/><a:font script="Uigh" typeface="Microsoft Uighur"/><a:font script="Geor" typeface="Sylfaen"/><a:font script="Armn" typeface="Arial"/><a:font script="Bugi" typeface="Leelawadee UI"/><a:font script="Bopo" typeface="Microsoft JhengHei"/><a:font script="Java" typeface="Javanese Text"/><a:font script="Lisu" typeface="Segoe UI"/><a:font script="Mymr" typeface="Myanmar Text"/><a:font script="Nkoo" typeface="Ebrima"/><a:font script="Olck" typeface="Nirmala UI"/><a:font script="Osma" typeface="Ebrima"/><a:font script="Phag" typeface="Phagspa"/><a:font script="Syrn" typeface="Estrangelo Edessa"/><a:font script="Syrj" typeface="Estrangelo Edessa"/><a:font script="Syre" typeface="Estrangelo Edessa"/><a:font script="Sora" typeface="Nirmala UI"/><a:font script="Tale" typeface="Microsoft Tai Le"/><a:font script="Talu" typeface="Microsoft New Tai Lue"/><a:font script="Tfng" typeface="Ebrima"/></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:lumMod val="110000"/><a:satMod val="105000"/><a:tint val="67000"/></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:lumMod val="105000"/><a:satMod val="103000"/><a:tint val="73000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:lumMod val="105000"/><a:satMod val="109000"/><a:tint val="81000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0"/></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:satMod val="103000"/><a:lumMod val="102000"/><a:tint val="94000"/></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:satMod val="110000"/><a:lumMod val="100000"/><a:shade val="100000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:lumMod val="99000"/><a:satMod val="120000"/><a:shade val="78000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="6350" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/><a:miter lim="800000"/></a:ln><a:ln w="12700" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/><a:miter lim="800000"/></a:ln><a:ln w="19050" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/><a:miter lim="800000"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst/></a:effectStyle><a:effectStyle><a:effectLst/></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="57150" dist="19050" dir="5400000" algn="ctr" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="63000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:solidFill><a:schemeClr val="phClr"><a:tint val="95000"/><a:satMod val="170000"/></a:schemeClr></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="93000"/><a:satMod val="150000"/><a:shade val="98000"/><a:lumMod val="102000"/></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:tint val="98000"/><a:satMod val="130000"/><a:shade val="90000"/><a:lumMod val="103000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="63000"/><a:satMod val="120000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0"/></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/><a:extLst><a:ext uri="{05A4C25C-085E-4340-85A3-A5531E510DB2}"><thm15:themeFamily xmlns:thm15="http://schemas.microsoft.com/office/thememl/2012/main" name="Office Theme" id="{62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F}" vid="{4A3C46E8-61CC-4603-A589-7422A47A8E4A}"/></a:ext></a:extLst></a:theme>`,xlWorkbookXml:`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x15 xr xr6 xr10 xr2" xmlns:x15="http://schemas.microsoft.com/office/spreadsheetml/2010/11/main" xmlns:xr="http://schemas.microsoft.com/office/spreadsheetml/2014/revision" xmlns:xr6="http://schemas.microsoft.com/office/spreadsheetml/2016/revision6" xmlns:xr10="http://schemas.microsoft.com/office/spreadsheetml/2016/revision10" xmlns:xr2="http://schemas.microsoft.com/office/spreadsheetml/2015/revision2"><fileVersion appName="xl" lastEdited="7" lowestEdited="7" rupBuild="20325"/><workbookPr defaultThemeVersion="166925"/><mc:AlternateContent xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"><mc:Choice Requires="x15"><x15ac:absPath url="C:\Users\jqwidgets\Desktop\" xmlns:x15ac="http://schemas.microsoft.com/office/spreadsheetml/2010/11/ac"/></mc:Choice></mc:AlternateContent><xr:revisionPtr revIDLastSave="0" documentId="13_ncr:1_{0DEDCB6D-5403-4CD8-AAA5-59B6D238A8B6}" xr6:coauthVersionLast="34" xr6:coauthVersionMax="34" xr10:uidLastSave="{00000000-0000-0000-0000-000000000000}"/><bookViews><workbookView xWindow="0" yWindow="0" windowWidth="19200" windowHeight="6950" xr2:uid="{0CB664E6-3800-4A88-B158-B46A682E7484}"/></bookViews><sheets><sheet name="Sheet1" sheetId="1" r:id="rId1"/></sheets><calcPr calcId="179021"/><extLst><ext uri="{140A7094-0E35-4892-8432-C4D2E57EDEB5}" xmlns:x15="http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"><x15:workbookPr chartTrackingRefBase="1"/></ext></extLst></workbook>`,Content_TypesXml:`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="bin" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings"/><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Default Extension="xml" ContentType="application/xml"/><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/><Override PartName="/xl/theme/theme1.xml" ContentType="application/vnd.openxmlformats-officedocument.theme+xml"/><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/><Override PartName="/xl/sharedStrings.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"/><Override PartName="/docProps/core.xml" ContentType="application/vnd.openxmlformats-package.core-properties+xml"/><Override PartName="/docProps/app.xml" ContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml"/></Types>`}}generateDefaultStyle(e){const t=this,l={},o=t.datafields,n=t.complexHeader?e[t.complexHeader.length]:e[+t.exportHeader];if(!n)return l;for(let t=0;t<o.length;t++){const e=n[o[t]];e instanceof Date&&(!l.columns&&(l.columns=[]),l.columns[o[t]]={format:"d"})}return l}generateGroupRow(e){const t=e.rowNumber,l="A"+t,o=`        <row r="${t}" outlineLevel="${e.outlineLevel}" spans="1:${e.numberOfColumns}"${this.getCustomRowHeight(t-1)} x14ac:dyDescent="0.45">
            <c r="${l}" t="s" s="0">
                <v>${e.sharedStringIndex}</v>
            </c>
        </row>\n`;return e.mergedCells.push({from:l,to:this.columnsArray[e.numberOfColumns-1]+t}),o}generateSharedStrings(e){function t(e){a++,-1===n.indexOf(e)&&(i++,n.push(e),r+=`<si><t>${e}</t></si>`)}const l=this,o=l.datafields,n=[];let r="",a=0,i=0;for(let l=0;l<e.length;l++){const n=e[l];for(let e,l=0;l<o.length;l++)(e=n[o[l]],"string"==typeof e)&&t(e)}if(l.groupLabels)for(let e=0;e<l.groupLabels.length;e++)t(l.groupLabels[e]);return r=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="${a}" uniqueCount="${i}">${r}</sst>`,{collection:n,xml:r}}generateSheet1(e,t){function l(e,t){return o.columnsArray[e]+t}const o=this,n=o.columnsArray.length,r=e.length,a=o.columnsArray[n-1]+r,i=o.datafields,d=o.getFilters(),s=[].concat(o.complexHeaderMergedCells);let p=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac xr xr2 xr3" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns:xr="http://schemas.microsoft.com/office/spreadsheetml/2014/revision" xmlns:xr2="http://schemas.microsoft.com/office/spreadsheetml/2015/revision2" xmlns:xr3="http://schemas.microsoft.com/office/spreadsheetml/2016/revision3" xr:uid="{7F25248B-C640-4C64-AD47-C0EA0E5D90D0}">
    <sheetPr filterMode="${""!==d}" />
    <dimension ref="A1:${a}" />
    <sheetViews>
        <sheetView tabSelected="1" workbookViewId="0" />
    </sheetViews>
    <sheetFormatPr defaultRowHeight="14.5" x14ac:dyDescent="0.35" />${o.getCustomColumnWidths()}
    <sheetData>\n`;for(let r=0;r<=e.length;r++){const a=e[r],d=r+1;let s="";if(o.actualHierarchy){const t=e[r-1];t&&t._collapsed&&(!a||t._level>a._level)&&(s=" collapsed=\"true\"")}if(r===e.length){s&&(p+=`        <row r="${d}" outlineLevel="${Math.max(e[r-1]._level-2,0)}" hidden="false" collapsed="true" />\n`);break}let c=`        <row r="${d}"${o.getOutlineLevel(a)} hidden="${a._hidden||a._collapsed||!1}"${s} spans="1:${n}"${o.getCustomRowHeight(d-1)} x14ac:dyDescent="0.45">\n`;for(let e=0;e<i.length;e++){const n=o.getXLSXCellStyle(l(e,d));c+=o.getActualCellData(a[i[e]],{r:l(e,d),s:n},t)}c+="        </row>\n",p+=c}return p+=`    </sheetData>${o.conditionalFormattingXLSX.conditions}${d}${o.getMergedCells(s)}
    <pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3" />
    <pageSetup paperSize="9" orientation="portrait" r:id="rId1" />
</worksheet>`,p}generateSheet1WithGrouping(e,t){function l(e,t){return o.columnsArray[e]+t}const o=this,n=o.columnsArray.length,r=e.length,a=o.columnsArray[n-1]+r,d=o.datafields,s=[].concat(o.complexHeaderMergedCells);let p=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac xr xr2 xr3" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns:xr="http://schemas.microsoft.com/office/spreadsheetml/2014/revision" xmlns:xr2="http://schemas.microsoft.com/office/spreadsheetml/2015/revision2" xmlns:xr3="http://schemas.microsoft.com/office/spreadsheetml/2016/revision3" xr:uid="{7F25248B-C640-4C64-AD47-C0EA0E5D90D0}">
    <dimension ref="A1:${a}" />
    <sheetViews>
        <sheetView tabSelected="1" workbookViewId="0" />
    </sheetViews>
    <sheetFormatPr defaultRowHeight="14.5" x14ac:dyDescent="0.35" />${o.getCustomColumnWidths()}
    <sheetData>\n`,c=0,u=[];mainLoop:for(let r=0;r<e.length;r++){const a=e[r],i=r+1+c;let h=0,m="";if(!o.exportHeader||!o.complexHeader&&0!=r||o.complexHeader&&r>=o.complexHeader.length){let e="";for(let l=0;l<o.groupBy.length;l++){const d=o.groupBy[l],m=a[d],g=o.groups[d][m];if(e+=m,-1===u.indexOf(e)){let l=t.indexOf(g);p+=o.generateGroupRow({rowNumber:i,outlineLevel:h,numberOfColumns:n,sharedStringIndex:l,mergedCells:s}),u.push(e),r--,c++;continue mainLoop}h++}m=` outlineLevel="${h}"`}let g=`        <row r="${i}"${m} spans="1:${n}"${o.getCustomRowHeight(i-1)} x14ac:dyDescent="0.45">\n`;for(let e=0;e<d.length;e++){const n=o.getXLSXCellStyle(l(e,r+1));g+=o.getActualCellData(a[d[e]],{r:l(e,i),s:n},t)}g+="        </row>\n",p+=g}return p+=`    </sheetData>${o.getMergedCells(s)}
    <pageMargins left="0.7" right="0.7" top="0.75" bottom="0.75" header="0.3" footer="0.3" />
    <pageSetup paperSize="9" orientation="portrait" r:id="rId1" />
</worksheet>`,p}getActualCellData(e,t,l){const o=t.r,n=t.s||" s=\"0\"";if("string"==typeof e)return`            <c r="${o}" t="s"${n}>
                <v>${l.indexOf(e)}</v>
            </c>\n`;if("boolean"==typeof e)return`            <c r="${o}" t="b"${n}>
                <v>${+e}</v>
            </c>\n`;if(e instanceof Date){const t=(e.getTime()+this.timeBetween1900And1970)/864e5+2;return`            <c r="${o}"${n}>
                <v>${t}</v>
            </c>\n`}return`            <c r="${o}"${n}>
                <v>${e}</v>
            </c>\n`}getColumnsArray(){function e(e){return 26>e?"":t(64+Math.floor(e/26))}var t=String.fromCharCode;const l=this,o=l.datafields.length,n=[];for(let l=0;l<o;l++)n.push(e(l)+t(65+(26>l?l:l%26)));l.columnsArray=n}getColumnStyle(){const e=this,t=e.style;if(!t)return`        .header { border: 1px solid black; padding: 5px; }
        .column { border: 1px solid black; padding: 5px; }
        .group { background-color: #FFFFFF; color: #000000; font-weight: bold; }`;const l={header:"border: 1px solid black; padding: 5px; ",column:"white-space: nowrap; overflow: hidden; border: 1px solid black; padding: 5px; ",group:"background-color: #FFFFFF; color: #000000; font-weight: bold; "},o=e.data[0];let n="";const r=t.header||{};for(let t in r){if(!r.hasOwnProperty(t))continue;const n=r[t];if(o[t]){for(let e in l["header"+t]||(l["header"+t]=""),n)if(n.hasOwnProperty(e)){const o=Smart.Utilities.Core.toDash(e)+": "+n[e]+"; ";l["header"+t]+=o,"width"==e&&(!l["column"+t]&&(l["column"+t]=""),l["column"+t]+=o)}continue}l.header+="height"==t&&e.complexHeader?"height: "+parseInt(r[t],10)/e.complexHeader.length+"px; ":Smart.Utilities.Core.toDash(t)+": "+r[t]+"; "}const a=t.columns||{};for(let e in a){if(!a.hasOwnProperty(e))continue;const t=a[e];if(o[e]){for(let o in l["column"+e]||(l["column"+e]=""),t)isNaN(o)&&t.hasOwnProperty(o)&&"format"!=o&&(l["column"+e]+=Smart.Utilities.Core.toDash(o)+": "+t[o]+"; ");continue}l.column+=Smart.Utilities.Core.toDash(e)+": "+t+"; "}for(let e in l)l.hasOwnProperty(e)&&(n+=`        .${e} { ${l[e]}}\n`);return n}getCustomColumnWidths(){const e=this;if(!e.style||!e.columnWidth||0===e.columnWidth.length)return"";let t="\n    <cols>\n";for(let l,o=0;o<e.columnWidth.length;o++)l=e.columnWidth[o],void 0!==l&&(l=Math.round(parseFloat(l))/11,t+=`        <col min="${o+1}" max="${o+1}" width="${l}" customWidth="1" />\n`);return t+="    </cols>",t}getCustomFilter(e,t){let l,o="equal";return e instanceof Date&&(e=(e.getTime()+this.timeBetween1900And1970)/864e5+2),t=t.toUpperCase(),("EMPTY"===t?l="":"NOT_EMPTY"===t?(l="",o="notEqual"):"CONTAINS"===t||"CONTAINS_CASE_SENSITIVE"===t?l=`*${e}*`:"DOES_NOT_CONTAIN"===t||"DOES_NOT_CONTAIN_CASE_SENSITIVE"===t?(l=`*${e}*`,o="notEqual"):"STARTS_WITH"===t||"STARTS_WITH_CASE_SENSITIVE"===t?l=`${e}*`:"ENDS_WITH"===t||"ENDS_WITH_CASE_SENSITIVE"===t?l=`*${e}`:"EQUAL"===t||"EQUAL_CASE_SENSITIVE"===t?l=e:"NULL"===t?l=null:"NOT_NULL"===t?(l=null,o="notEqual"):"NOT_EQUAL"===t?(l=e,o="notEqual"):"LESS_THAN"===t?(l=e,o="lessThan"):"LESS_THAN_OR_EQUAL"===t?(l=e,o="lessThanOrEqual"):"GREATER_THAN"===t?(l=e,o="greaterThan"):"GREATER_THAN_OR_EQUAL"===t?(l=e,o="greaterThanOrEqual"):void 0,`                <customFilter val="${l}" operator="${o}"/>\n`)}getCustomRowHeight(e){const t=this;return t.style?t.rowHeight[e]||t.defaultRowHeight||"":""}getDatafields(e){const t=this,l=e[0],o=[];for(let t in l)l.hasOwnProperty(t)&&"_"!==t.charAt(0)&&o.push(t);t.datafields=o}getFilters(){const e=this,t=e.filterBy;if(!t)return"";let l="";for(let o in t)if(t.hasOwnProperty(o)){const n=e.datafields.indexOf(o);if(-1===n)continue;const r=t[o],a=r.filters;l+=`        <filterColumn colId="${n}">
            <customFilters and="${!r.operator}">\n`;for(let t=0;t<a.length;t++)l+=e.getCustomFilter(a[t].value,a[t].condition);l+=`            </customFilters>
        </filterColumn>`}return l?(l=`\n    <autoFilter ref="A1:${e.columnsArray[e.columnsArray.length-1]+e.data.length}">\n${l}\n    </autoFilter>`,l):""}getGroupLabels(e){const t=this,l=t.xlsxStartIndex===void 0?+t.exportHeader:t.xlsxStartIndex,o={},n=[];for(let r=l;r<e.length;r++){const a=e[r];for(let r=0;r<t.groupBy.length;r++){const i=t.groupBy[r],d=a[i];let s=o[i];s===void 0&&(o[i]={},s=o[i]),s[d]===void 0&&(s[d]=(t.exportHeader?e[l-1][i]:i)+": "+d,n.push(s[d]))}}t.groups=o,t.groupLabels=n}getHTMLHeader(e,t){const l=this;let o="\n        <thead>\n";if(!l.complexHeader){o+="            <tr>\n";for(let l=0;l<e.length;l++){const n=e[l];o+=`                <th class="header header${n}">${t[0][n]}</th>\n`}return o+="            </tr>\n        </thead>",o}for(let n=0;n<l.complexHeader.length;n++){const t=l.complexHeader[n];o+="            <tr>\n";for(let r=0;r<t.length;r++){const a=t[r];let i=1,d=1;if(t[r-1]&&t[r-1]===a||l.complexHeader[n-1]&&l.complexHeader[n-1][r]===a)continue;let s=r+1;for(;t[s]&&t[s]===t[s-1];)i++,s++;for(s=n+1;l.complexHeader[s]&&l.complexHeader[s][r]===a;)d++,s++;const p=n==l.complexHeader.length-1||d+n===l.complexHeader.length?" header"+e[r]:"";o+=`                <th class="header${p}" colspan="${i}" rowspan="${d}">${a}</th>\n`}o+="            </tr>\n"}return o+="        </thead>",o}getConditionalFormatting(){const e=this,t=e.conditionalFormatting;if(!t)return void(e.conditionalFormattingXLSX={conditions:"",styles:""});const l=[];let o="",n="";for(let r=t.length-1;0<=r;r--){const a=t[r],i=e.columnsArray[e.datafields.indexOf(a.column)],d=i+(e.xlsxStartIndex+1),s=d+":"+i+e.data.length,p=a.background+a.color,c=e.getConditionalAttributes(a,d);let u=l.indexOf(p);if(-1===u){const t=`        <dxf>
            <font>
                <b val="0"/>
                <i val="0"/>
                <color rgb="${"White"===a.color?"FFFFFFFF":"FF000000"}"/>
                <sz val="10"/>
            </font>
            <fill>
                <patternFill>
                    <bgColor rgb="${e.toARGB(a.background)}"/>
                </patternFill>
            </fill>
        </dxf>\n`;n+=t,u=l.length,l.push(p)}o+=`    <conditionalFormatting sqref="${s}">
        <cfRule dxfId="${u}" text="${c.text}" rank="${c.rank}" percent="${c.percent}" bottom="${c.bottom}" equalAverage="${c.equalAverage}" aboveAverage="${c.aboveAverage}"${c.operator}${c.timePeriod} priority="${r+2}" type="${c.type}">
${c.formula}        </cfRule>
    </conditionalFormatting>\n`}n=`    <dxfs count="${l.length}">\n${n}    </dxfs>`,e.conditionalFormattingXLSX={conditions:o,styles:n}}getConditionalAttributes(e,t){let l=e.condition,o=e.comparator,n="",r=0,a=0,i=0,d=0,s="",p="",c="",u="";return"equal"===l?(s="equal",c="cellIs",u=`            <formula>${o}</formula>\n`):"lessThan"===l?(s="lessThan",c="cellIs",u=`            <formula>${o}</formula>\n`):"greaterThan"===l?(s="greaterThan",c="cellIs",u=`            <formula>${o}</formula>\n`):"notEqual"===l?(s="notEqual",c="cellIs",u=`            <formula>${o}</formula>\n`):"between"===l?(s="between",c="cellIs",u=`            <formula>${e.min}</formula>
            <formula>${e.max}</formula>\n`):"duplicate"===l?(c="duplicateValues",u="            <formula>0</formula>\n"):"topNItems"===l?(r=o,c="top10"):"bottomNItems"===l?(r=o,i=1,c="top10"):"topNPercent"===l?(r=o,a=1,c="top10"):"bottomNPercent"===l?(r=o,a=1,i=1,c="top10"):"aboveAverage"===l?(d=1,c="aboveAverage",u="            <formula>0</formula>\n"):"belowAverage"===l?(c="aboveAverage",u="            <formula>0</formula>\n"):"contains"===l?(n=o,s="containsText",c="containsText",u=`            <formula>NOT(ISERROR(SEARCH("${o}",${t})))</formula>\n`):"doesNotContain"===l?(n=o,s="notContains",c="notContainsText",u=`            <formula>ISERROR(SEARCH("${o}",${t}))</formula>\n`):"dateOccur"===l?(p=` timePeriod="${o}"`,c="timePeriod"):void 0,s&&(s=` operator="${s}" `),{text:n,rank:r,percent:a,bottom:i,equalAverage:0,aboveAverage:d,operator:s,timePeriod:p,type:c,formula:u}}getMergedCells(e){const t=this;let l="";for(let t=0;t<e.length;t++)e[t].from!==e[t].to&&(l+=`\n        <mergeCell ref="${e[t].from}:${e[t].to}" />\n`);if(t.mergedCells)for(let e=0;e<t.mergedCells.length;e++){const o=t.mergedCells[e];if(2>o.rowspan&&2>o.colspan)continue;const n=t.columnsArray[o.cell[0]]+(o.cell[1]+t.xlsxStartIndex+1),r=t.columnsArray[o.cell[0]+o.colspan-1]+(o.cell[1]+t.xlsxStartIndex+o.rowspan);l+=`\n        <mergeCell ref="${n}:${r}" />\n`}return l&&(l=`\n    <mergeCells count="${e.length}">${l}    </mergeCells>`),l}getNumFmtIndex(e,t){let l=t.collection.indexOf(e);return-1===l?(l=t.collection.length+100,t.collection.push(e),t.xml+=`<numFmt numFmtId="${l}" formatCode="${e}"/>`):l+=100,l}getOutlineLevel(e){return this.actualHierarchy&&1!==e._level?` outlineLevel="${e._level-1}"`:""}getRowStyle(){const e=this,t=e.style;if(!t)return"";const l=t.rows;if(!l)return"";const o={row:""};let n="";for(let e in l){if(!l.hasOwnProperty(e)||"alternationCount"==e||"alternationStart"==e||"alternationEnd"==e)continue;const t=l[e];if(-1!==e.indexOf("alt")){const l=e.slice(16,17),n=e.slice(17);o["rowN"+l]||(o["rowN"+l]=""),o["rowN"+l]+="Color"===n?"color : "+t+"; ":"BorderColor"===n?"border-color : "+t+"; ":"background-color : "+t+"; ";continue}if(!isNaN(e)){for(let l in o["row"+e]||(o["row"+e]=""),t)t.hasOwnProperty(l)&&(o["row"+e]+=Smart.Utilities.Core.toDash(l)+": "+t[l]+"; ");continue}o.row+=Smart.Utilities.Core.toDash(e)+": "+l[e]+"; "}let r=Object.keys(o);r.sort(function(e,t){if("row"===e)return-1;if("row"===t)return 1;const l=!isNaN(e.slice(3)),o=!isNaN(t.slice(3));return l&&!o?1:!l&&o?-1:+(e<t)});for(let e=0;e<r.length;e++)n+=`        .${r[e]} { ${o[r[e]]}}\n`;return n}getTableStyle(){const e=this,t=e.style;if(!t)return" style=\"table-layout: fixed; border: 1px solid black; border-collapse: collapse;\"";let l="table-layout: fixed; ";for(let e in t)t.hasOwnProperty(e)&&-1===["header","columns","rows"].indexOf(e)&&(l+=Smart.Utilities.Core.toDash(e)+": "+t[e]+"; ");return l&&(l=" style=\""+l+"\""),l}getXLSXCellStyle(e){const t=this;return void 0===t.cellStyleMapping[e]?"":` s="${t.cellStyleMapping[e]}"`}getXLSXFormat(e,t){if("number"==typeof t){let t=parseFloat(e.slice(1))||0,l=0<t?"."+"0".repeat(t):"";return e=e.slice(0,1),"C"===e||"c"===e?"$#,0"+l:"D"===e||"d"===e?t?"0".repeat(t):"0":"E"===e||"e"===e?"0"+l+e+"000":"F"===e||"f"===e?"0"+l:"N"===e||"n"===e?"#,0"+l:"P"===e||"p"===e?"#,0"+l+" %":void 0}return t instanceof Date?"d"===e?"m/d/yyyy":"D"===e?"nnnnmmmm dd, yyyy":"t"===e?"h:m AM/PM":"T"===e?"h:mm:ss AM/PM":"f"===e?"nnnnmmmm dd, yyyy h:m AM/PM":"F"===e?"nnnnmmmm dd, yyyy h:mm:ss AM/PM":"M"===e?"mmmm d":"Y"===e?"yyyy mmmm":"FP"===e||"PP"===e?"yyyy-mm-dd hh:mm:ss":"FT"===e||"PT"===e?"hh:mm:ss":(e=e.replace(/f|u|n|p|e|a|x|o/gi,""),e=e.replace(/tt/gi,"AM/PM"),e=e.replace(/:{2,}|:\s|:$|\.$/g,""),e=e.trim(),e):void 0}processColumnStyle(e){const t=this,l=e.header,o=e.columns,n=t.data[0],r=t.xlsxStartIndex;if(t.columnWidth=[],r&&l)for(let e=0;e<t.columnsArray.length;e++){const o=t.columnsArray[e],a=o+r,i=l[t.datafields[e]];for(let e in l)if(l.hasOwnProperty(e)&&void 0===n[e])if(t.complexHeader){for(let n=0;n<t.complexHeader.length;n++)if("height"==e){t.rowHeight[n]=` ht="${parseFloat(l.height)/t.complexHeader.length/2}"`;continue}else t.storeCellStyle(o+(n+1),e,l[e]);}else{if("height"==e){t.rowHeight[0]=` ht="${parseFloat(l.height)/2}"`;continue}t.storeCellStyle(a,e,l[e])}if(i)for(let l in i)if(i.hasOwnProperty(l)){if("width"==l){t.columnWidth[e]=i.width;continue}t.storeCellStyle(a,l,i[l])}}else if(l)for(let e=0;e<t.columnsArray.length;e++){const o=l[t.datafields[e]];o&&void 0!==o.width&&(t.columnWidth[e]=o.width)}if(!o)return"";for(let l=r;l<t.data.length;l++)for(let e=0;e<t.columnsArray.length;e++){const r=t.columnsArray[e],a=r+(l+1),i=t.datafields[e],d=o[i];for(let e in o)o.hasOwnProperty(e)&&void 0===n[e]&&t.storeCellStyle(a,e,o[e]);if(d)for(let e in d)isNaN(e)&&d.hasOwnProperty(e)&&t.storeCellStyle(a,e,d[e],t.data[l][i])}}processComplexHeader(e,t,l){function o(t){for(let l=0;l<e.columngroups.length;l++){const o=e.columngroups[l];if(o.name===t)return o}}function n(e){for(const t=[];e;)if(t.unshift(e.label),e.parentGroup)e=o(e.parentGroup);else return t}const r=this,a={},d=-1!==["html","pdf","xlsx"].indexOf(l)&&e.columngroups,s=[],p={},c=[];let u=0;if(d){for(let t=0;t<e.columngroups.length;t++){const l=e.columngroups[t],o=n(l);p[l.name]=o,u=Math.max(u,o.length)}u++;for(let e=0;e<u;e++)c[e]=[]}for(let o=0;o<e.columns.length;o++){const t=e.columns[o];if(a[t.dataField]=t.label,!d)continue;if(s[o]=t.dataField,c[u-1][o]=t.label,!t.columnGroup)continue;const l=p[t.columnGroup];for(let e=0;e<l.length;e++)c[e][o]=l[e]}if(1<c.length){const e=Object.keys(a).length;for(let o=0;o<u-1;o++){const n={};for(let t=0;t<e;t++){if(void 0===c[o][t]){let e=o+1;for(;void 0===c[e][t];)e++;c[o][t]=c[e][t]}n[s[t]]=c[o][t]}"xlsx"===l&&t.splice(o,0,n)}if(r.complexHeader=c,"xlsx"!==l)t.unshift(a);else{t.splice(u-1,0,a);const l={};for(let t=0;t<u;t++)for(let o=0;o<e;o++){const e=c[t][o];l[e]?l[e].to=[t,o]:(l[e]={from:[t,o]},l[e].to=l[e].from)}r.complexHeaderMergeInfo=l}}else t.unshift(a)}processHierarchicalData(e,t){function l(e,t,o){const r=d[e];if(i=n(i,t),void 0!==r)for(let e=0;e<r.length;e++){const n=r[e],a=n._keyDataField;n._collapsed=o,n._level=t,s.push(n),d[a]&&(p=!0,n._expanded=void 0===n._expanded||n._expanded,l(a,t+1,o||!n._expanded))}}function o(e,l,r){const a=d[e];if(i=n(i,l),void 0!==a)for(let e=0;e<a.length;e++){const n=a[e],i=n._keyDataField;let s;if("json"===t)for(let e in s={},n)n.hasOwnProperty(e)&&"_"!==e.charAt(0)&&(s[e]=n[e]);else s=Object.assign({},n);r.push(s),d[i]&&(p=!0,s.rows=[],o(i,l+1,s.rows))}}var n=Math.max;const r=this,a="xlsx"===t?r.xlsxStartIndex:+r.exportHeader,d={},s=[];let i=0,p=!1;if(void 0===e[a]._keyDataField)return r.processNestedData(e,t,a);for(let l=a;l<e.length;l++){const t=Object.assign({},e[l]),o=t._parentDataField;void 0===d[o]?d[o]=[t]:d[o].push(t)}if(a)for(let l=0;l<a;l++)s.push(Object.assign({},e[l])),-1===["json","pdf","xml"].indexOf(t)&&(s[l]._level=1);return"json"!==t&&"xml"!==t?l(null,1,!1):o(null,1,s),p||(r.actualHierarchy=!1),r.maxLevel=i,s}processNestedData(e,t,l){function o(e,t,l,n){i=r(i,l);for(let r=e;r<t.length;r++){const e=Object.assign({},t[r]);e._collapsed=n,e._level=l,d.push(e),e.children&&0<e.children.length&&(s=!0,e._expanded=void 0===e._expanded||e._expanded,o(0,e.children,l+1,n||!e._expanded)),delete e.children}}function n(e,t,l,o){i=r(i,o);for(let r=e;r<t.length;r++){const e=Object.assign({},t[r]);1===o?d[r]=e:l[r]=e,e.children&&0<e.children.length&&(s=!0,e.rows=[],n(0,e.children,e.rows,o+1)),delete e.children}}var r=Math.max;const a=this,d=[];let i=0,s=!1;if(l)for(let o=0;o<l;o++)d.push(Object.assign({},e[o])),-1===["json","pdf","xml"].indexOf(t)&&(d[o]._level=1);return"json"!==t&&"xml"!==t?o(l,e,1,!1):n(l,e,void 0,1),s||(a.actualHierarchy=!1),a.maxLevel=i,d}processRowStyle(e){function t(e,t,o){for(let r=0;r<l.columnsArray.length;r++){const a=l.columnsArray[r]+(e+1+n);l.storeCellStyle(a,t,o)}}const l=this,o=e.rows;if(l.rowHeight=[],!o)return;const n=l.xlsxStartIndex;o.height&&(l.defaultRowHeight=` ht="${parseFloat(o.height)/2}"`);for(let r=n;r<l.data.length;r++){const e=r-n;for(let l in o)o.hasOwnProperty(l)&&-1===l.indexOf("alt")&&isNaN(l)&&"height"!=l&&t(e,l,o[l]);if(o.alternationCount&&!(o.alternationStart&&e<o.alternationStart)&&!(o.alternationEnd&&e>o.alternationEnd)){const l=o.alternationStart||0,n=(e-l)%o.alternationCount;o[`alternationIndex${n}Color`]&&t(e,"color",o[`alternationIndex${n}Color`]),o[`alternationIndex${n}BorderColor`]&&t(e,"borderColor",o[`alternationIndex${n}BorderColor`]),o[`alternationIndex${n}BackgroundColor`]&&t(e,"backgroundColor",o[`alternationIndex${n}BackgroundColor`])}if(o[e])for(let n in o[e])if(o[e].hasOwnProperty(n)){if("height"==n){l.rowHeight[r]=` ht="${parseFloat(o[e].height)/2}"`;continue}t(e,n,o[e][n])}}}storeCellStyle(e,t,l){const o=this,n=o.styleMap[e];switch(t){case"backgroundColor":n.fills.fgColor=l;break;case"color":n.fonts.color=l;break;case"fontFamily":n.fonts.name=l.replace(/"/g,"'");break;case"fontSize":n.fonts.sz=parseFloat(l);break;case"fontStyle":"italic"===l?n.fonts.i=!0:delete n.fonts.i;break;case"fontWeight":"bold"===l?n.fonts.b=!0:delete n.fonts.b;break;case"numFmt":{n.numFmt=l;break}case"textAlign":n.alignment.horizontal=l;break;case"textDecoration":"underline"===l?n.fonts.u=!0:delete n.fonts.u;break;case"verticalAlign":"middle"===l&&(l="center"),n.alignment.vertical=l;}}toARGB(e){e=e.replace(/\s/g,"");const t=/rgb\((\d+),(\d+),(\d+)\)/gi.exec(e);if(null!==t){const e=parseFloat(t[1]).toString(16).toUpperCase(),l=parseFloat(t[2]).toString(16).toUpperCase(),o=parseFloat(t[3]).toString(16).toUpperCase();return"FF"+"0".repeat(2-e.length)+e+"0".repeat(2-l.length)+l+"0".repeat(2-o.length)+o}const l=/rgba\((\d+),(\d+),(\d+)\,(\d*.\d+|\d+)\)/gi.exec(e);if(null!==l){const e=Math.round(255*parseFloat(l[4])).toString(16).toUpperCase(),t=parseFloat(l[1]).toString(16).toUpperCase(),o=parseFloat(l[2]).toString(16).toUpperCase(),n=parseFloat(l[3]).toString(16).toUpperCase();return"0".repeat(2-e.length)+e+"0".repeat(2-t.length)+t+"0".repeat(2-o.length)+o+"0".repeat(2-n.length)+n}const o=/^#(.)(.)(.)$/gi.exec(e);if(null!==o){const e=o[1].toUpperCase(),t=o[2].toUpperCase(),l=o[3].toUpperCase();return"FF"+e+e+t+t+l+l}return"FF"+e.toUpperCase().slice(1)}toggleableFunctionality(){const e=this;return e.actualHierarchy?`\n    <style type="text/css">
        .toggle-element {
            width: 5px;
            height: 1px;
            padding-right: 5px;
            float: left;
            text-align: right;
            cursor: pointer;
            user-select: none;
        }

        .collapsed {
            display: none;
        }
    </style>
    <script type="text/javascript">
        window.onload = function () {
            var expandChar = '${e.expandChar}',
                collapseChar = '${e.collapseChar}',
                toggleElements = document.getElementsByClassName('toggle-element');

            function getParent(child) {
                var prevSibling = child.previousElementSibling;

                while (prevSibling) {
                    if (child.getAttribute('level') > prevSibling.getAttribute('level')) {
                        return prevSibling;
                    }

                    prevSibling = prevSibling.previousElementSibling;
                }

            }

            function getFirstCollapsedAncestor(child) {
                var parent = getParent(child);

                while (parent) {
                    if (parent.firstElementChild.firstElementChild.innerHTML === expandChar) {
                        return parent;
                    }

                    parent = getParent(parent);
                }
            }

            for (var i = 0; i < toggleElements.length; i++) {
                toggleElements[i].addEventListener('click', function (event) {
                    var expanded = this.innerHTML === collapseChar,
                        row = this.parentElement.parentElement,
                        sibling = row.nextElementSibling;

                    if (expanded) {
                        this.innerHTML = expandChar;
                    }
                    else {
                        this.innerHTML = collapseChar;
                    }

                    while (sibling && row.getAttribute('level') < sibling.getAttribute('level')) {
                        if (expanded) {
                            sibling.style.display = 'none';
                        }
                        else {
                            var firstCollapsedAncestor = getFirstCollapsedAncestor(sibling);

                            if (!firstCollapsedAncestor || firstCollapsedAncestor === row) {
                                sibling.classList.remove('collapsed');
                                sibling.style.display = null;
                            }

                        }

                        sibling = sibling.nextElementSibling;
                    }
                });
            }
        }
    </script>`:""}generateStyles(e){const t=this;if(t.cellStyleMapping={},0===Object.keys(e).length&&!t.complexHeader)return`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac x16r2 xr" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns:x16r2="http://schemas.microsoft.com/office/spreadsheetml/2015/02/main" xmlns:xr="http://schemas.microsoft.com/office/spreadsheetml/2014/revision"><fonts count="1" x14ac:knownFonts="1"><font><sz val="11"/><color theme="1"/><name val="Calibri"/><family val="2"/><charset val="204"/><scheme val="minor"/></font></fonts><fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills><borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs><cellXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0" xfId="0"/></cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>${t.conditionalFormattingXLSX.styles||"<dxfs count=\"0\"/>"}<tableStyles count="0" defaultTableStyle="TableStyleMedium2" defaultPivotStyle="PivotStyleLight16"/><extLst><ext uri="{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"><x14:slicerStyles defaultSlicerStyle="SlicerStyleLight1"/></ext><ext uri="{9260A510-F301-46a8-8635-F512D64BE5F5}" xmlns:x15="http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"><x15:timelineStyles defaultTimelineStyle="TimeSlicerStyleLight1"/></ext></extLst></styleSheet>`;t.styleMap={};for(let l=0;l<t.data.length;l++)for(let e=0;e<t.columnsArray.length;e++)t.styleMap[t.columnsArray[e]+(l+1)]={numFmts:{},fonts:{},fills:{},borders:{},alignment:{}};if(e&&e.columns)for(let l=0;l<t.columnsArray.length;l++){const o=t.datafields[l];if(!e.columns[o]||!e.columns[o].format)continue;const n=t.getXLSXFormat(e.columns[o].format,t.data[t.data.length-1][o]);n&&(e.columns[o].numFmt=n)}t.processRowStyle(e),t.processColumnStyle(e);const l={};for(let o=0;o<t.complexHeaderMergedCells.length;o++){const e=t.complexHeaderMergedCells[o];if(parseFloat(e.to[1])===t.complexHeader.length){l[e.to]=e.from;continue}t.styleMap[e.from].alignment.horizontal="center",t.styleMap[e.from].alignment.vertical="center"}const o={xml:"<font><sz val=\"11\" /><color theme=\"1\" /><name val=\"Calibri\" /><family val=\"2\" /><charset val=\"204\" /><scheme val=\"minor\" /></font>",collection:["default"]},n={xml:"<fill><patternFill patternType=\"none\" /></fill><fill><patternFill patternType=\"gray125\" /></fill>",collection:["default","gray125"]},r={xml:"",collection:[]},a={xml:"<xf fontId=\"0\" fillId=\"0\" borderId=\"1\"/>",collection:["default"]};for(let d=0;d<t.data.length;d++)for(let e=0;e<t.columnsArray.length;e++){const i=t.columnsArray[e]+(d+1),s=t.styleMap[i];let p="",c="",u="",h=[],m=[],g=[],f=[];for(let e in s.fonts)if(s.fonts.hasOwnProperty(e)){const l=s.fonts[e];"color"==e?(h[0]=l,p+=`<color rgb="${t.toARGB(l)}" />`):"name"==e?(h[1]=l,p+=`<name val="${l}" />`):"sz"==e?(h[2]=l,p+=`<sz val="${l}" />`):"i"==e?(h[3]=l,p+="<i />"):"b"==e?(h[4]=l,p+="<b />"):"u"==e?(h[5]=l,p+="<u />"):void 0}for(let e in s.fills)if(s.fills.hasOwnProperty(e)){const l=s.fills[e];"fgColor"==e?(m[0]=l,c+=`<fgColor rgb="${t.toARGB(l)}" />`):void 0}for(let e in s.alignment)if(s.alignment.hasOwnProperty(e)){const t=s.alignment[e];"horizontal"==e?(g[0]=t,u+=`horizontal="${t}" `):"vertical"==e?(g[1]=t,u+=`vertical="${t}" `):void 0}if(h=h.toString(),m=m.toString(),""!=p){let e=o.collection.indexOf(h);-1===e&&(e=o.collection.length,o.xml+="<font>"+p+"</font>",o.collection.push(h)),f[0]=e}if(""!=c){let e=n.collection.indexOf(m);-1===e&&(e=n.collection.length,n.xml+="<fill><patternFill patternType=\"solid\">"+c+"</patternFill></fill>",n.collection.push(m)),f[1]=e}0<g.length&&(f[2]=u),void 0!==s.numFmt&&(f[3]=t.getNumFmtIndex(s.numFmt,r));const x=f.toString();if(""!==x){let e=a.collection.indexOf(x);if(-1===e){let t="<xf ";e=a.collection.length,void 0!==f[0]&&(t+=`fontId="${f[0]}" `),void 0!==f[1]&&(t+=`fillId="${f[1]}" `),void 0!==f[3]&&(t+=`numFmtId="${f[3]}" `),t+=void 0===f[2]?" borderId=\"1\"/>":`applyAlignment="1" borderId="1"><alignment ${u}/></xf>`,a.xml+=t,a.collection.push(x)}t.cellStyleMapping[l[i]||i]=e}}return r.collection.length&&(r.xml=`<numFmts count="${r.collection.length}">${r.xml}</numFmts>`),`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="x14ac x16r2 xr" xmlns:x14ac="http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac" xmlns:x16r2="http://schemas.microsoft.com/office/spreadsheetml/2015/02/main" xmlns:xr="http://schemas.microsoft.com/office/spreadsheetml/2014/revision">${r.xml}<fonts count="${o.collection.length}" x14ac:knownFonts="1">${o.xml}</fonts><fills count="${n.collection.length}">${n.xml}</fills><borders count="2"><border><left/><right/><top/><bottom/></border><border><left style="hair"/><right style="hair"/><top style="hair"/><bottom style="hair"/><diagonal/></border></borders><cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs><cellXfs count="${a.collection.length}">${a.xml}</cellXfs><cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>${t.conditionalFormattingXLSX.styles}<dxfs count="0"/><tableStyles count="0" defaultTableStyle="TableStyleMedium2" defaultPivotStyle="PivotStyleLight16"/><extLst><ext uri="{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}" xmlns:x14="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"><x14:slicerStyles defaultSlicerStyle="SlicerStyleLight1"/></ext><ext uri="{9260A510-F301-46a8-8635-F512D64BE5F5}" xmlns:x15="http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"><x15:timelineStyles defaultTimelineStyle="TimeSlicerStyleLight1"/></ext></extLst></styleSheet>`}});